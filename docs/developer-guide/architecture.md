# ğŸ—ï¸ æ¶æ„è®¾è®¡

æ¬¢è¿æ¥åˆ°å·§å…‹åŠ›æµ‹è¯•å¹³å°çš„"å†…åŠŸå¿ƒæ³•"ï¼è¿™é‡Œå°†æ­ç§˜å¹³å°çš„æ¶æ„è®¾è®¡ï¼Œè®©ä½ äº†è§£è¿™ä¸ªæµ‹è¯•å¹³å°æ˜¯å¦‚ä½•"ç‚¼æˆ"çš„ã€‚

## ğŸ¯ æ•´ä½“æ¶æ„æ¦‚è§ˆ

### æŠ€æœ¯æ ˆé€‰æ‹©
å·§å…‹åŠ›æµ‹è¯•å¹³å°é‡‡ç”¨ç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18**: ç°ä»£åŒ–çš„å‰ç«¯æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨çš„JavaScriptè¶…é›†
- **Ant Design Pro**: ä¼ä¸šçº§UIè§£å†³æ–¹æ¡ˆ
- **UmiJS 4**: å¯æ‰©å±•çš„ä¼ä¸šçº§å‰ç«¯åº”ç”¨æ¡†æ¶
- **ProComponents**: é«˜çº§ç»„ä»¶åº“

#### åç«¯æŠ€æœ¯æ ˆ
- **Flask**: è½»é‡çº§Python Webæ¡†æ¶
- **SQLAlchemy**: Python ORMæ¡†æ¶
- **Celery**: åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—
- **Redis**: ç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—
- **MySQL**: å…³ç³»å‹æ•°æ®åº“

#### æµ‹è¯•æŠ€æœ¯æ ˆ
- **Pytest**: Pythonæµ‹è¯•æ¡†æ¶
- **Locust**: æ€§èƒ½æµ‹è¯•å·¥å…·
- **Requests**: HTTPè¯·æ±‚åº“

### æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯åº”ç”¨       â”‚    â”‚   åç«¯API       â”‚    â”‚   æµ‹è¯•å¼•æ“       â”‚
â”‚  (React+TS)     â”‚â—„â”€â”€â–ºâ”‚   (Flask)       â”‚â—„â”€â”€â–ºâ”‚ (Pytest+Locust) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é™æ€èµ„æº       â”‚    â”‚   æ•°æ®å­˜å‚¨       â”‚    â”‚   ä»»åŠ¡é˜Ÿåˆ—       â”‚
â”‚   (CDN/Nginx)   â”‚    â”‚ (MySQL+Redis)   â”‚    â”‚   (Celery)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ å‰ç«¯æ¶æ„è®¾è®¡

### ç›®å½•ç»“æ„
```
src/
â”œâ”€â”€ components/          # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ RightContent/   # å³ä¾§å†…å®¹ç»„ä»¶
â”‚   â””â”€â”€ Footer/         # é¡µè„šç»„ä»¶
â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ openapitest/    # æ¥å£æµ‹è¯•é¡µé¢
â”‚   â”œâ”€â”€ LocustTest/     # å‹åŠ›æµ‹è¯•é¡µé¢
â”‚   â”œâ”€â”€ Project/        # é¡¹ç›®ç®¡ç†é¡µé¢
â”‚   â””â”€â”€ User/           # ç”¨æˆ·ç›¸å…³é¡µé¢
â”œâ”€â”€ services/           # APIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ test_case/      # æµ‹è¯•ç”¨ä¾‹æœåŠ¡
â”‚   â”œâ”€â”€ test_suite/     # æµ‹è¯•å¥—ä»¶æœåŠ¡
â”‚   â”œâ”€â”€ test_plan/      # æµ‹è¯•è®¡åˆ’æœåŠ¡
â”‚   â””â”€â”€ locust_*/       # Locustç›¸å…³æœåŠ¡
â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â””â”€â”€ typings.d.ts        # ç±»å‹å®šä¹‰
```

### ç»„ä»¶è®¾è®¡åŸåˆ™

#### å•ä¸€èŒè´£åŸåˆ™
æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ï¼š
```typescript
// å¥½çš„è®¾è®¡ - å•ä¸€èŒè´£
const TestCaseList = () => {
  // åªè´Ÿè´£å±•ç¤ºæµ‹è¯•ç”¨ä¾‹åˆ—è¡¨
};

const TestCaseForm = () => {
  // åªè´Ÿè´£æµ‹è¯•ç”¨ä¾‹è¡¨å•
};
```

#### ç»„ä»¶å¤ç”¨æ€§
è®¾è®¡å¯å¤ç”¨çš„é€šç”¨ç»„ä»¶ï¼š
```typescript
// é€šç”¨è¡¨æ ¼ç»„ä»¶
interface ProTableProps<T> {
  columns: ProColumns<T>[];
  request: (params: any) => Promise<any>;
  actionRef?: React.MutableRefObject<ActionType>;
}
```

### çŠ¶æ€ç®¡ç†

#### å…¨å±€çŠ¶æ€
ä½¿ç”¨UmiJSçš„åˆå§‹çŠ¶æ€ç®¡ç†å…¨å±€æ•°æ®ï¼š
```typescript
// app.tsx
export async function getInitialState() {
  return {
    currentUser: await fetchUserInfo(),
    settings: defaultSettings,
  };
}
```

#### é¡µé¢çŠ¶æ€
ä½¿ç”¨React Hooksç®¡ç†é¡µé¢çº§çŠ¶æ€ï¼š
```typescript
const [loading, setLoading] = useState(false);
const [dataSource, setDataSource] = useState([]);
const actionRef = useRef<ActionType>();
```

### è·¯ç”±è®¾è®¡

#### è·¯ç”±ç»“æ„
```typescript
// config/routes.ts
export default [
  {
    path: '/openapitest',
    name: 'æ¥å£æµ‹è¯•',
    icon: 'api',
    routes: [
      {
        path: '/openapitest/case',
        name: 'ç”¨ä¾‹ç®¡ç†',
        component: './openapitest/caseList',
      },
      {
        path: '/openapitest/suite',
        name: 'å¥—ä»¶ç®¡ç†',
        component: './openapitest/caseSuiteList',
      },
    ],
  },
];
```

#### æƒé™æ§åˆ¶
åŸºäºç”¨æˆ·è§’è‰²çš„è·¯ç”±æƒé™æ§åˆ¶ï¼š
```typescript
// access.ts
export default function access(initialState) {
  const { currentUser } = initialState ?? {};
  return {
    canAdmin: currentUser && currentUser.access === 1,
    canTest: currentUser && currentUser.access === 0,
  };
}
```

## ğŸ”§ åç«¯æ¶æ„è®¾è®¡

### æœåŠ¡åˆ†å±‚æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controller    â”‚  # æ§åˆ¶å™¨å±‚ - å¤„ç†HTTPè¯·æ±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Service      â”‚  # æœåŠ¡å±‚ - ä¸šåŠ¡é€»è¾‘å¤„ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      DAO        â”‚  # æ•°æ®è®¿é—®å±‚ - æ•°æ®åº“æ“ä½œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Model       â”‚  # æ¨¡å‹å±‚ - æ•°æ®æ¨¡å‹å®šä¹‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### APIè®¾è®¡è§„èŒƒ

#### RESTful APIè®¾è®¡
```python
# èµ„æºå‘½åè§„èŒƒ
GET    /api/auto_pytest/get_case          # è·å–æµ‹è¯•ç”¨ä¾‹
POST   /api/auto_pytest/create_suite      # åˆ›å»ºæµ‹è¯•å¥—ä»¶
PUT    /api/auto_pytest/update_plan       # æ›´æ–°æµ‹è¯•è®¡åˆ’
DELETE /api/auto_pytest/delete_project    # åˆ é™¤é¡¹ç›®
```

#### ç»Ÿä¸€å“åº”æ ¼å¼
```python
{
    "success": true,
    "data": {
        # å…·ä½“æ•°æ®
    },
    "msg": "æ“ä½œæˆåŠŸ",
    "code": 200
}
```

### æ•°æ®åº“è®¾è®¡

#### æ ¸å¿ƒè¡¨ç»“æ„
```sql
-- é¡¹ç›®è¡¨
CREATE TABLE test_project (
    id INT PRIMARY KEY AUTO_INCREMENT,
    project_name VARCHAR(255) NOT NULL,
    project_desc TEXT,
    project_owners VARCHAR(255),
    add_time DATETIME,
    update_time DATETIME,
    is_deleted BOOLEAN DEFAULT FALSE
);

-- æµ‹è¯•ç”¨ä¾‹è¡¨
CREATE TABLE test_case (
    id INT PRIMARY KEY AUTO_INCREMENT,
    case_func VARCHAR(255) NOT NULL,
    case_func_desc TEXT,
    case_sence VARCHAR(255),
    moudle_id INT,
    path_desc TEXT,
    tags VARCHAR(255),
    update_time DATETIME
);

-- æµ‹è¯•å¥—ä»¶è¡¨
CREATE TABLE test_suite (
    id INT PRIMARY KEY AUTO_INCREMENT,
    suite_name VARCHAR(255) NOT NULL,
    describe TEXT,
    project_id INT,
    case_ids TEXT,
    test_type VARCHAR(50),
    test_env VARCHAR(50),
    add_time DATETIME,
    update_time DATETIME
);
```

#### æ•°æ®å…³ç³»è®¾è®¡
```
Project (1) â”€â”€â”€â”€ (N) TestSuite
TestSuite (N) â”€â”€â”€â”€ (N) TestCase
TestSuite (1) â”€â”€â”€â”€ (N) TestPlan
TestPlan (1) â”€â”€â”€â”€ (N) TestResult
```

## ğŸ”„ æµ‹è¯•å¼•æ“æ¶æ„

### Pytesté›†æˆæ¶æ„
```python
# æµ‹è¯•æ‰§è¡Œæµç¨‹
class TestExecutor:
    def __init__(self, suite_config):
        self.suite_config = suite_config
        
    def execute(self):
        # 1. å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
        self.setup_environment()
        
        # 2. æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
        result = self.run_tests()
        
        # 3. æ”¶é›†æµ‹è¯•ç»“æœ
        self.collect_results(result)
        
        # 4. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
        self.generate_report()
```

### Locusté›†æˆæ¶æ„
```python
# å‹åŠ›æµ‹è¯•æ‰§è¡Œæµç¨‹
class LocustExecutor:
    def __init__(self, locust_config):
        self.config = locust_config
        
    def start_test(self):
        # 1. å¯åŠ¨Locust Master
        self.start_master()
        
        # 2. å¯åŠ¨WorkerèŠ‚ç‚¹
        self.start_workers()
        
        # 3. å¼€å§‹å‹åŠ›æµ‹è¯•
        self.begin_test()
        
        # 4. ç›‘æ§æµ‹è¯•è¿‡ç¨‹
        self.monitor_test()
```

### ä»»åŠ¡é˜Ÿåˆ—æ¶æ„
```python
# Celeryä»»åŠ¡å®šä¹‰
@celery.task
def execute_test_suite(suite_id, env):
    """å¼‚æ­¥æ‰§è¡Œæµ‹è¯•å¥—ä»¶"""
    try:
        # æ‰§è¡Œæµ‹è¯•
        result = TestExecutor(suite_id, env).execute()
        
        # ä¿å­˜ç»“æœ
        save_test_result(result)
        
        # å‘é€é€šçŸ¥
        send_notification(result)
        
    except Exception as e:
        # é”™è¯¯å¤„ç†
        handle_error(e)
```

## ğŸ” å®‰å…¨æ¶æ„è®¾è®¡

### è®¤è¯æˆæƒ
```python
# JWT Tokenè®¤è¯
class AuthMiddleware:
    def __init__(self):
        self.secret_key = config.SECRET_KEY
        
    def verify_token(self, token):
        try:
            payload = jwt.decode(token, self.secret_key)
            return payload['user_id']
        except jwt.ExpiredSignatureError:
            raise AuthError('Tokenå·²è¿‡æœŸ')
        except jwt.InvalidTokenError:
            raise AuthError('æ— æ•ˆToken')
```

### æƒé™æ§åˆ¶
```python
# åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
class PermissionManager:
    PERMISSIONS = {
        'admin': ['read', 'write', 'delete', 'manage'],
        'tester': ['read', 'write'],
        'viewer': ['read']
    }
    
    def check_permission(self, user_role, action):
        return action in self.PERMISSIONS.get(user_role, [])
```

### æ•°æ®å®‰å…¨
- **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨ORMå‚æ•°åŒ–æŸ¥è¯¢
- **XSSé˜²æŠ¤**: å‰ç«¯è¾“å…¥éªŒè¯å’Œè½¬ä¹‰
- **CSRFé˜²æŠ¤**: ä½¿ç”¨CSRF Token
- **æ•æ„Ÿæ•°æ®åŠ å¯†**: å¯†ç å’Œæ•æ„Ÿé…ç½®åŠ å¯†å­˜å‚¨

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—æ¶æ„

### åº”ç”¨ç›‘æ§
```python
# æ€§èƒ½ç›‘æ§
class PerformanceMonitor:
    def __init__(self):
        self.metrics = {}
        
    def record_api_call(self, endpoint, duration):
        if endpoint not in self.metrics:
            self.metrics[endpoint] = []
        self.metrics[endpoint].append(duration)
        
    def get_avg_response_time(self, endpoint):
        times = self.metrics.get(endpoint, [])
        return sum(times) / len(times) if times else 0
```

### æ—¥å¿—ç³»ç»Ÿ
```python
# ç»“æ„åŒ–æ—¥å¿—
import logging
import json

class StructuredLogger:
    def __init__(self):
        self.logger = logging.getLogger(__name__)
        
    def log_api_request(self, request, response, duration):
        log_data = {
            'timestamp': datetime.now().isoformat(),
            'method': request.method,
            'url': request.url,
            'status_code': response.status_code,
            'duration': duration,
            'user_id': request.user.id if request.user else None
        }
        self.logger.info(json.dumps(log_data))
```

## ğŸš€ éƒ¨ç½²æ¶æ„

### å®¹å™¨åŒ–éƒ¨ç½²
```dockerfile
# Dockerfileç¤ºä¾‹
FROM node:16-alpine AS frontend-build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM python:3.9-slim AS backend
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD ["python", "app.py"]
```

### å¾®æœåŠ¡æ¶æ„
```yaml
# docker-compose.yml
version: '3.8'
services:
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
      
  backend:
    build: ./backend
    ports:
      - "5000:5000"
    depends_on:
      - mysql
      - redis
      
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: password
      
  redis:
    image: redis:6.2-alpine
    
  celery:
    build: ./backend
    command: celery worker -A app.celery
    depends_on:
      - redis
```

## ğŸ’¡ è®¾è®¡åŸåˆ™å’Œæœ€ä½³å®è·µ

### SOLIDåŸåˆ™åº”ç”¨
1. **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªç±»å’Œå‡½æ•°åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **å¼€é—­åŸåˆ™**: å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
3. **é‡Œæ°æ›¿æ¢åŸåˆ™**: å­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»
4. **æ¥å£éš”ç¦»åŸåˆ™**: ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£
5. **ä¾èµ–å€’ç½®åŸåˆ™**: ä¾èµ–æŠ½è±¡è€Œä¸æ˜¯å…·ä½“å®ç°

### å¯æ‰©å±•æ€§è®¾è®¡
- **æ’ä»¶åŒ–æ¶æ„**: æ”¯æŒåŠŸèƒ½æ’ä»¶æ‰©å±•
- **é…ç½®åŒ–é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶è¡Œä¸º
- **äº‹ä»¶é©±åŠ¨**: ä½¿ç”¨äº‹ä»¶æœºåˆ¶è§£è€¦ç»„ä»¶
- **å¾®æœåŠ¡åŒ–**: æŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†æœåŠ¡

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **å‰ç«¯ä¼˜åŒ–**: ä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ã€ç¼“å­˜ç­–ç•¥
- **åç«¯ä¼˜åŒ–**: æ•°æ®åº“ç´¢å¼•ã€æŸ¥è¯¢ä¼˜åŒ–ã€ç¼“å­˜æœºåˆ¶
- **ç½‘ç»œä¼˜åŒ–**: CDNã€å‹ç¼©ã€HTTP/2
- **ç³»ç»Ÿä¼˜åŒ–**: è´Ÿè½½å‡è¡¡ã€é›†ç¾¤éƒ¨ç½²

---

> ğŸ‰ **æ¶æ„å¸ˆï¼** ä½ å·²ç»äº†è§£äº†å·§å…‹åŠ›æµ‹è¯•å¹³å°çš„æ¶æ„ç²¾é«“ã€‚å¥½çš„æ¶æ„ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè€Œæ˜¯åœ¨å®è·µä¸­ä¸æ–­æ¼”è¿›å’Œä¼˜åŒ–çš„ï¼
